"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("color-preview"),t=document.querySelectorAll(".option-button"),o=(t,o,n)=>{let r={};void 0!==t&&Object.assign(r,{r:t}),void 0!==o&&Object.assign(r,{g:o}),void 0!==n&&Object.assign(r,{b:n});let c=new URLSearchParams(r).toString(),a=`opt=${null!=localStorage.getItem("option")?localStorage.getItem("option"):"f"}`;c.length>0&&fetch(`/api?${c}&${a}`).then((e=>e.json())).then((({r:t,g:o,b:n})=>{const r=`rgb(${t}, ${o}, ${n})`;e.style.backgroundColor=r})).catch((e=>console.error("Error fetching color:",e)))};t.forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-option");console.log(`Opción seleccionada: ${t}`),localStorage.setItem("option",t),fetch(`/api?option=${t}`).then((e=>{e.ok?console.log(`Opción ${t} enviada al ESP32`):console.error("Error al enviar la opción al ESP32")}))}))})),o();const n=document.getElementById("input-color"),r=n.getContext("2d"),c=new Image;c.crossOrigin="Anonymous",c.setAttribute("crossOrigin",""),c.addEventListener("load",(()=>{r.drawImage(c,0,0,320,320)}),!1),c.addEventListener("error",(()=>{console.error("Error loading the image.")}),!1),c.src="./chroma.png";const a=function(e){let t,n;if(e.touches&&e.touches.length>0)t=e.touches[0].clientX-e.touches[0].target.offsetLeft,n=e.touches[0].clientY-e.touches[0].target.offsetTop;else{if(!e.clientX||!e.clientY)return void console.error("No se pudo obtener las coordenadas del evento.");t=e.clientX-e.target.offsetLeft,n=e.clientY-e.target.offsetTop}const c=r.getImageData(t,n,1,1).data;o(c[0],c[1],c[2])};n.addEventListener("touchstart",a),n.addEventListener("touchmove",a),e.addEventListener("click",(()=>o(0,0,0))),e.addEventListener("touchstart",(()=>o(0,0,0)))}));